---
layout: post
title: "iOSのCI環境をCircleCIに移行した"
date: 2018-02-08 23:46 +0900
---

移行前はBitriseの$50のプランでiOSのCIをしていました。最近はサーバーやAndroidの開発もやっているのですが、そちらのCIには元々CircleCIを使っていて、workflowの使いやすさやページの軽快さが気に入っていました。

CircleCIのmacOSマシンは$39から始められるのですが、一定時間以上使うとそこから従量課金制になります。CircleCI上でのビルドにどのくらい時間が掛かるか完全には読めなかったので、実際に移行してみて費用が安くなるのか高くなるのか不確定だったというわけです。そういう状況だと、わざわざ確認のために新しい環境でCIをセットアップするのも億劫に感じてしまい、なかなか手をつけられずにいました。

ところがある日、サーバーのリソースを見直した結果、月に$250ほど節約できることがわかりました。なぜかその時に背中を押されて、iOSをCircleCIに移行してコストが多少増えてたとしても許容できるなと思い、CircleCIの無料トライアルを始めました。

## Bitriseからのフィードバック依頼

Bitriseは退会ユーザーになんでやめちゃったの？というメールを送っているみたいでした。この取り組みは自社サービスでも真似させてもらおうと思ったのもあり、せっかくなのでマジメに答えました。

1つ目の理由は、複数のプラットフォームで同じようにワークフローを管理したいということでした。今のチームのメンバーもこれから入る予定の人もマルチスキルなので、iOSだけ特別な方法で管理するよりは、統一な方法で管理できるサービスの方が魅力的というわけです。

2つ目の理由は、ビルドページの読み込みが異常に遅いということでした。ビルド失敗時は早く何が起きているのか確認したいのに、ビルドログの読み込みに数分かかることもあってフラストレーションがたまることがありました。

2つ目の方はブーメランにならないように気をつけたいものです。

## CircleCIを使ってみて

まず、見るべき場所が1つ減ったのが地味にうれしかったです。心配していたビルドの速度はまったく問題なく、むしろBitriseの時よりも少し速いくらいでした。

プランは結局$129のものにしたのでコスト増ですが、他プラットフォームとの共通ワークフローや並列ビルドなどを得られましたし、待ち時間のストレスも減らせたので、いまのところ満足しています。
