{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/1587269750/",
    "result": {"data":{"site":{"siteMetadata":{"title":"ishkawa"}},"markdownRemark":{"id":"32a68dc2-f6b3-5323-a74c-4e6a798c45ad","excerpt":"いつの間にかCircleCIのジョブにパラメーターを設定できるようになっていた。そして、パラメーターの組み合わせでbuild matrixを構成できるようになっていた。昔に設定した時にこれらの機能がなくて憤慨していた記憶があるので、比較的最近に導入された機能だと思う。 ジョブのパラメーターとbuild matrix…","html":"<p>いつの間にかCircleCIのジョブにパラメーターを設定できるようになっていた。そして、パラメーターの組み合わせでbuild matrixを構成できるようになっていた。昔に設定した時にこれらの機能がなくて憤慨していた記憶があるので、比較的最近に導入された機能だと思う。</p>\n<h2>ジョブのパラメーターとbuild matrix</h2>\n<p>ジョブのパラメーターは、ステップが共通した複数のジョブを1つにまとめる時に役立つ。</p>\n<p>例えばモバイルアプリの開発では、ストアにリリースされるアプリのビルドの他に、接続先を開発用サーバーに変更したアプリのビルドや、署名の方法を変更したアプリのビルドなどが必要になる。この差分をパラメーターとして定義しておけば、ジョブを1つにまとめることができ、各々のビルドに対するジョブを1から書く必要はなくなる。</p>\n<p>build matrixは、ジョブのパラメーターを組み合わせて構成するビルド群のこと。サーバーにproductionとdevelopmentがあり、署名の方法にApp StoreとAd Hocがあった場合、パラメーターの組み合わせには以下の4つがある。</p>\n<ul>\n<li>production / App Store</li>\n<li>production / Ad Hoc</li>\n<li>development / App Store</li>\n<li>development / Ad Hoc</li>\n</ul>\n<h2>CircleCIの設定</h2>\n<p>以下の手順でbuild matrixを構成できる。</p>\n<ul>\n<li><code class=\"language-text\">jobs</code>で<code class=\"language-text\">parameters</code>を定義する。</li>\n<li><code class=\"language-text\">workflows</code>の<code class=\"language-text\">jobs</code>で<code class=\"language-text\">parameters</code>のmatrixを定義する。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">version: 2.1\n\njobs:\n  build:\n    parameters:\n      server:\n        type: string\n      codesign:\n        type: string\n    steps:\n      - checkout\n      - run: echo \"&lt;&lt; parameters.server >> &lt;&lt; parameters.codesign >>\"\n\nworkflows:\n  build:\n    jobs:\n      - build:\n          matrix:\n            parameters:\n              server: [\"development\", \"production\"]\n              codesign: [\"appstore\", \"adhoc\"]</code></pre></div>\n<p>これで、1つのジョブで4つのビルドを担えるようになった。</p>\n<h2>参考ドキュメント</h2>\n<ul>\n<li><a href=\"https://circleci.com/docs/2.0/reusing-config/#authoring-parameterized-jobs\">Reusable Config Reference Guide</a></li>\n<li><a href=\"https://circleci.com/docs/2.0/configuration-reference/#matrix-requires-version-21\">Configuring CircleCI</a></li>\n</ul>","frontmatter":{"title":"CircleCIでbuild matrixを構成する","date":"2020/04/19","description":"","image":null}}},"pageContext":{"slug":"/1587269750/","previous":{"fields":{"slug":"/1585787944/"},"frontmatter":{"title":"全社リモートワークになったので通話のプラクティスを考えた"}},"next":{"fields":{"slug":"/1589505986/"},"frontmatter":{"title":"社内向け不具合報告ガイドを公開する"}}}},
    "staticQueryHashes": ["2841359383"]}